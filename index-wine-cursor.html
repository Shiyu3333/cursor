<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
    <title>è–›å®šè°”çš„çŒ«ğŸ±</title>
    <style>
        body {
            background: #1a1a1a;
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50,20 L60,40 L80,45 L65,60 L70,80 L50,70 L30,80 L35,60 L20,45 L40,40 Z" fill="white" opacity="0.3"/><path d="M50,30 L55,40 L65,43 L55,50 L58,60 L50,55 L42,60 L45,50 L35,43 L45,40 Z" fill="white" opacity="0.3"/></svg>');
            background-size: 200px;
            background-repeat: repeat;
            opacity: 0.3;
            z-index: -1;
            pointer-events: none;
        }

        .title {
            font-size: 3.5rem;
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 1.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            letter-spacing: -0.5px;
            position: relative;
        }

        .title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, #ff6b6b, #ff8e8e);
        }

        .subtitle {
            font-size: 1.2rem;
            color: #b3b3b3;
            margin-bottom: 3rem;
            text-align: center;
            font-weight: 500;
        }

        .assistant-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2.5rem;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .assistant-card {
            background: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 2.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .assistant-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff6b6b, #ff8e8e);
            border-radius: 4px 4px 0 0;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .assistant-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 107, 107, 0.3);
        }

        .assistant-card:hover::before {
            opacity: 1;
        }

        .assistant-icon {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            color: #ff6b6b;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .assistant-name {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: #ffffff;
            letter-spacing: -0.5px;
        }

        .assistant-description {
            color: #b3b3b3;
            margin-bottom: 1.5rem;
            line-height: 1.6;
            font-size: 1.1rem;
            font-weight: 400;
        }

        .chat-container {
            display: none;
            background: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin: 2rem;
            position: relative;
            overflow: hidden;
        }

        .chat-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff6b6b, #ff8e8e);
            border-radius: 4px 4px 0 0;
        }

        .chat-messages {
            height: 400px;
            overflow-y: auto;
            padding: 2rem;
            background-color: transparent;
            border-radius: 24px;
            margin-top: 4rem;
        }

        .message {
            margin-bottom: 1.5rem;
            padding: 1.2rem 1.5rem;
            border-radius: 20px;
            max-width: 80%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            position: relative;
            font-size: 1.1rem;
            line-height: 1.5;
        }

        .message.user {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }

        .message.bot {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            margin-right: auto;
            border-bottom-left-radius: 4px;
        }

        .chat-input {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            padding: 0 2rem 2rem;
        }

        .chat-input input {
            flex: 1;
            padding: 1rem 1.5rem;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }

        .chat-input input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.2);
            border-color: rgba(255, 107, 107, 0.3);
        }

        .chat-input button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%);
            color: white;
            padding: 1rem 1.8rem;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            font-weight: 500;
        }

        .chat-input button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(255, 107, 107, 0.3);
        }

        .back-button {
            position: fixed;
            top: 2rem;
            left: 2rem;
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(255, 107, 107, 0.3);
        }

        .blind-box-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            visibility: hidden;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .blind-box-container.show {
            visibility: visible;
            opacity: 1;
        }

        .blind-box {
            width: 20vw;
            min-width: 200px;
            aspect-ratio: 1;
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%);
            border-radius: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transform: scale(0);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .blind-box.show {
            transform: scale(1);
        }

        .blind-box:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .blind-box-content {
            text-align: center;
            color: white;
        }

        .blind-box-content i {
            font-size: 3rem;
            margin-bottom: 1rem;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .blind-box-content p {
            font-size: 1.2rem;
            font-weight: 500;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .menu-container {
            display: none;
            background: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .drink-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .drink-card {
            background: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .drink-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 107, 107, 0.3);
        }

        .drink-image-container {
            position: relative;
            width: 100%;
            height: 250px;
            overflow: hidden;
            border-radius: 12px 12px 0 0;
        }

        .drink-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .drink-image:hover {
            transform: scale(1.1);
        }

        .drink-content {
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            flex: 1;
            justify-content: space-between;
        }

        .drink-info {
            flex: 1;
        }

        .drink-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 0.5rem;
            line-height: 1.2;
            height: 3.6rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .drink-price {
            font-size: 1.2rem;
            color: #ff6b6b;
            margin-bottom: 1rem;
        }

        .drink-description {
            color: #b3b3b3;
            margin-bottom: 1rem;
            line-height: 1.6;
            height: 4.8rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .drink-fortune {
            color: #ff8e8e;
            font-style: italic;
            margin-bottom: 1rem;
            padding: 0.8rem;
            background: rgba(255, 107, 107, 0.1);
            border-radius: 12px;
            height: 4rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .button-container {
            margin-top: auto;
        }

        .add-to-order {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
            width: 100%;
        }

        .add-to-order:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(255, 107, 107, 0.3);
        }

        .order-container {
            display: none;
            background: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 2rem;
            max-width: 800px;
            margin: 0 auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .order-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .order-item:last-child {
            border-bottom: none;
        }

        .item-info {
            flex: 1;
        }

        .item-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 0.5rem;
        }

        .item-price {
            color: #ff6b6b;
            font-size: 1.1rem;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .quantity-button {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quantity-button:hover {
            background: rgba(255, 107, 107, 0.3);
        }

        .quantity {
            color: #ffffff;
            font-size: 1.2rem;
            min-width: 30px;
            text-align: center;
        }

        .total-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            color: #ffffff;
            font-size: 1.2rem;
        }

        .total-amount {
            font-size: 1.5rem;
            font-weight: 600;
            color: #ff6b6b;
        }

        .table-number {
            margin-top: 2rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .table-number input {
            width: 100%;
            padding: 0.8rem;
            background: transparent;
            border: none;
            color: #ffffff;
            font-size: 1.1rem;
        }

        .table-number input:focus {
            outline: none;
        }

        .submit-order {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%);
            color: white;
            padding: 1rem 2rem;
            border-radius: 30px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2rem;
            font-weight: 500;
            width: 100%;
            margin-top: 2rem;
        }

        .submit-order:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(255, 107, 107, 0.3);
        }

        .nav-buttons {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            display: flex;
            gap: 1rem;
        }

        .nav-button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%);
            color: white;
            padding: 1rem 2rem;
            border-radius: 30px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .nav-button:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 30px rgba(255, 107, 107, 0.3);
        }
    </style>
</head>

<body>
    <div class="container mx-auto px-4 py-8">
        <h1 class="title text-center">è–›å®šè°”çš„çŒ«ğŸ±</h1>
        <p class="subtitle">é€‰æ‹©ä¸€ä½æ™ºèƒ½åŠ©æ‰‹ï¼Œå¼€å¯æ‚¨çš„é…’æ°´ä¹‹æ—…</p>
        
        <div class="assistant-grid" id="assistant-grid">
            <div class="assistant-card" data-assistant="mixologist">
                <i class="fas fa-cocktail assistant-icon"></i>
                <h3 class="assistant-name">è°ƒé…’å¸ˆ</h3>
                <p class="assistant-description">ä¸“ä¸šè°ƒé…’å¸ˆï¼Œç²¾é€šå„ç±»é¸¡å°¾é…’è°ƒåˆ¶ï¼Œèƒ½ä¸ºæ‚¨æ¨èæœ€é€‚åˆçš„é¥®å“æ­é…</p>
            </div>
            
            <div class="assistant-card" data-assistant="sommelier">
                <i class="fas fa-wine-glass-alt assistant-icon"></i>
                <h3 class="assistant-name">å“é…’å¸ˆ</h3>
                <p class="assistant-description">èµ„æ·±å“é…’å¸ˆï¼Œç†Ÿæ‚‰å„ç±»è‘¡è„é…’ï¼Œèƒ½ä¸ºæ‚¨æä¾›ä¸“ä¸šçš„å“é‰´å»ºè®®</p>
            </div>
            
            <div class="assistant-card" data-assistant="bartender">
                <i class="fas fa-beer assistant-icon"></i>
                <h3 class="assistant-name">é…’ä¿</h3>
                <p class="assistant-description">ç»éªŒä¸°å¯Œçš„é…’ä¿ï¼Œäº†è§£å„ç±»å•¤é…’å’Œçƒˆé…’ï¼Œèƒ½ä¸ºæ‚¨æ¨èæœ€å—æ¬¢è¿çš„é¥®å“</p>
            </div>
            
            <div class="assistant-card" data-assistant="tea-master">
                <i class="fas fa-mug-hot assistant-icon"></i>
                <h3 class="assistant-name">èŒ¶è‰ºå¸ˆ</h3>
                <p class="assistant-description">èŒ¶è‰ºå¤§å¸ˆï¼Œç²¾é€šå„ç±»èŒ¶é¥®ï¼Œèƒ½ä¸ºæ‚¨æ¨èæœ€é€‚åˆçš„èŒ¶é¥®æ­é…</p>
            </div>
        </div>

        <div id="chat-container" class="chat-container">
            <button class="back-button" id="back-button">
                <i class="fas fa-arrow-left"></i> è¿”å›
            </button>
            <div class="chat-messages" id="chat-messages"></div>
            <div class="chat-input">
                <input type="text" id="user-input" placeholder="è¾“å…¥æ‚¨çš„é—®é¢˜...">
                <button id="send-button">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>

        <div id="menu-container" class="menu-container">
            <div class="drink-grid" id="drink-grid">
                <!-- é¥®å“å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <div id="order-container" class="order-container">
            <div id="order-items">
                <!-- è®¢å•é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>

            <div class="total-section">
                <div class="total-row">
                    <span>å°è®¡</span>
                    <span id="subtotal">Â¥0</span>
                </div>
                <div class="total-row">
                    <span>æœåŠ¡è´¹</span>
                    <span>Â¥0</span>
                </div>
                <div class="total-row total-amount">
                    <span>æ€»è®¡</span>
                    <span id="total">Â¥0</span>
                </div>
            </div>

            <div class="table-number">
                <input type="text" id="table-number" placeholder="è¯·è¾“å…¥æ¡Œå·">
            </div>

            <button class="submit-order" onclick="submitOrder()">
                æäº¤è®¢å•
            </button>
        </div>
    </div>

    <div class="nav-buttons">
        <button class="nav-button" id="menu-button" style="display: none;">
            <i class="fas fa-utensils"></i>
            æŸ¥çœ‹èœå•
        </button>
        <button class="nav-button" id="order-button" style="display: none;">
            <i class="fas fa-shopping-cart"></i>
            æŸ¥çœ‹è®¢å•
        </button>
    </div>

    <div id="blind-box-container" class="blind-box-container">
        <div id="blind-box" class="blind-box">
            <div class="blind-box-content">
                <i class="fas fa-gift"></i>
                <p>ç‚¹å‡»å¼€å¯æƒŠå–œ</p>
            </div>
        </div>
    </div>

    <script>
        // åŠ©æ‰‹æ•°æ®
        const assistants = [
            {
                name: "è°ƒé…’å¸ˆ",
                icon: "fa-cocktail",
                description: "ä¸“ä¸šè°ƒé…’å¸ˆï¼Œç²¾é€šå„ç±»é¸¡å°¾é…’è°ƒåˆ¶ï¼Œèƒ½ä¸ºæ‚¨æ¨èæœ€é€‚åˆçš„é¥®å“æ­é…"
            },
            {
                name: "å“é…’å¸ˆ",
                icon: "fa-wine-glass-alt",
                description: "èµ„æ·±å“é…’å¸ˆï¼Œç†Ÿæ‚‰å„ç±»è‘¡è„é…’ï¼Œèƒ½ä¸ºæ‚¨æä¾›ä¸“ä¸šçš„å“é‰´å»ºè®®"
            },
            {
                name: "é…’ä¿",
                icon: "fa-beer",
                description: "ç»éªŒä¸°å¯Œçš„é…’ä¿ï¼Œäº†è§£å„ç±»å•¤é…’å’Œçƒˆé…’ï¼Œèƒ½ä¸ºæ‚¨æ¨èæœ€å—æ¬¢è¿çš„é¥®å“"
            },
            {
                name: "èŒ¶è‰ºå¸ˆ",
                icon: "fa-mug-hot",
                description: "èŒ¶è‰ºå¤§å¸ˆï¼Œç²¾é€šå„ç±»èŒ¶é¥®ï¼Œèƒ½ä¸ºæ‚¨æ¨èæœ€é€‚åˆçš„èŒ¶é¥®æ­é…"
            }
        ];

        // å›¾ç‰‡æœç´¢APIé…ç½®
        const imageAPIs = {
            'è°ƒé…’å¸ˆ': {
                'æ¢¦å¹»æ˜Ÿç©ºç‰¹è°ƒ': 'https://images.unsplash.com/photo-1514362545857-3bc16c4c7d1b',
                'æ‹æ‹æ°”æ³¡': 'https://images.unsplash.com/photo-1536935338788-846bb9981813',
                'é­”æ³•å½©è™¹ç‰¹è°ƒ': 'https://images.unsplash.com/photo-1486947799489-3fabdd7d32a6',
                'é»˜è®¤': 'https://images.unsplash.com/photo-1514362545857-3bc16c4c7d1b'
            },
            'å“é…’å¸ˆ': {
                'é™ˆå¹´æ³¢å°”å¤š': 'https://images.unsplash.com/photo-1510812431401-41d2bd2722f3',
                'æ™®ç½—æ—ºæ–¯æ¡ƒçº¢': 'https://images.unsplash.com/photo-1553361371-9b22f78e8b1d',
                'æ„å¤§åˆ©èµ·æ³¡é…’': 'https://images.unsplash.com/photo-1558001373-7b93ee48ffa0',
                'é»˜è®¤': 'https://images.unsplash.com/photo-1510812431401-41d2bd2722f3'
            },
            'é…’ä¿': {
                'é™ˆå¹´å¨å£«å¿Œ': 'https://images.unsplash.com/photo-1527281400683-1aae777175f8',
                'ç²¾é…¿å•¤é…’': 'https://images.unsplash.com/photo-1608270586620-248524c67de9',
                'æœé¦™å•¤é…’': 'https://images.unsplash.com/photo-1618183479302-1e0aa382c36b',
                'é»˜è®¤': 'https://images.unsplash.com/photo-1527281400683-1aae777175f8'
            },
            'èŒ¶è‰ºå¸ˆ': {
                'å¤§çº¢è¢': 'https://images.unsplash.com/photo-1576092768241-dec231879fc3',
                'æ˜å‰é¾™äº•': 'https://images.unsplash.com/photo-1582793988951-9aed5509eb97',
                'æ­¦å¤·çº¢èŒ¶': 'https://images.unsplash.com/photo-1544787219-7f47ccb76574',
                'é»˜è®¤': 'https://images.unsplash.com/photo-1576092768241-dec231879fc3'
            }
        };

        // é¥®å“åº“å­˜æ•°æ®
        const drinkInventory = {
            'è°ƒé…’å¸ˆ': [
                {
                    name: "æ¢¦å¹»æ˜Ÿç©ºç‰¹è°ƒ",
                    price: 88,
                    description: "åˆ›æ–°è°ƒåˆ¶çš„æ¢¦å¹»é¸¡å°¾é…’ï¼Œæ­é…ç‰¹åˆ¶è£…é¥°ï¼Œå‘ˆç°ç‹¬ç‰¹è§†è§‰æ•ˆæœã€‚",
                    keywords: ["æ¢¦å¹»", "ç‰¹è°ƒ", "é¸¡å°¾é…’"],
                    fortune: "ç¹æ˜Ÿç‚¹ç‚¹ï¼Œæ¯ä¸€å£éƒ½æ˜¯ä¸€åœºæµæ˜Ÿé›¨çš„é‚‚é€…ã€‚",
                    image: "https://images.unsplash.com/photo-1514362545857-3bc16c4c7d1b"
                },
                {
                    name: "æ‹æ‹æ°”æ³¡",
                    price: 78,
                    description: "æ¸…æ–°æœé¦™ä¸æ°”æ³¡çš„é‚‚é€…ï¼Œæ­é…ç²¾è‡´è£…é¥°ï¼Œå°‘å¥³å¿ƒæ»¡æ»¡ã€‚",
                    keywords: ["æ¸…æ–°", "æœé¦™", "æ°”æ³¡"],
                    fortune: "ç²‰çº¢æ³¡æ³¡ï¼Œè®©å¿ƒè·³åŠ é€Ÿçš„å°ç¡®å¹¸ã€‚",
                    image: "https://images.unsplash.com/photo-1536935338788-846bb9981813"
                },
                {
                    name: "é­”æ³•å½©è™¹ç‰¹è°ƒ",
                    price: 98,
                    description: "å¤šå±‚æ¸å˜çš„æ¢¦å¹»é¸¡å°¾é…’ï¼Œæ­é…åˆ›æ„è£…é¥°ï¼Œè§†è§‰ä¸å‘³è§‰çš„åŒé‡äº«å—ã€‚",
                    keywords: ["é­”æ³•", "å½©è™¹", "ç‰¹è°ƒ"],
                    fortune: "å½©è™¹èˆ¬ç»šä¸½çš„å¿ƒæƒ…ï¼Œå°½åœ¨è¿™ä¸€æ¯ä¸­ã€‚",
                    image: "https://images.unsplash.com/photo-1486947799489-3fabdd7d32a6"
                }
            ],
            'å“é…’å¸ˆ': [
                {
                    name: "é™ˆå¹´æ³¢å°”å¤š",
                    price: 188,
                    description: "ä¼˜é›…é†‡åšçš„çº¢é…’ï¼Œè•´å«é»‘é†‹æ —ä¸æ©¡æœ¨æ¡¶çš„èŠ³é¦™ã€‚",
                    keywords: ["çº¢é…’", "æ³¢å°”å¤š", "é™ˆå¹´"],
                    fortune: "æ—¶å…‰æ²‰æ·€ï¼Œæˆå°±å®Œç¾é£éŸµã€‚",
                    image: "https://images.unsplash.com/photo-1510812431401-41d2bd2722f3"
                },
                {
                    name: "æ™®ç½—æ—ºæ–¯æ¡ƒçº¢",
                    price: 158,
                    description: "å¦‚åŒæ™®ç½—æ—ºæ–¯çš„é˜³å…‰ï¼Œæ¸…æ–°æ€¡äººçš„æ¡ƒçº¢è‘¡è„é…’ã€‚",
                    keywords: ["æ¡ƒçº¢", "æ¸…æ–°", "è‘¡è„é…’"],
                    fortune: "ç²‰è‰²çš„æµªæ¼«ï¼Œå—æ³•çš„å¾®é†ºã€‚",
                    image: "https://images.unsplash.com/photo-1553361371-9b22f78e8b1d"
                },
                {
                    name: "æ„å¤§åˆ©èµ·æ³¡é…’",
                    price: 128,
                    description: "æ¥è‡ªæ„å¤§åˆ©çš„æ¸…æ–°èµ·æ³¡é…’ï¼Œå¸¦æœ‰æ°´æœä¸èŠ±é¦™ã€‚",
                    keywords: ["èµ·æ³¡é…’", "æœé¦™", "æ¸…æ–°"],
                    fortune: "æ°”æ³¡ä¸­æµæ·Œçš„æ¬¢æ„‰æ—¶å…‰ã€‚",
                    image: "https://images.unsplash.com/photo-1558001373-7b93ee48ffa0"
                }
            ],
            'é…’ä¿': [
                {
                    name: "é™ˆå¹´å¨å£«å¿Œ",
                    price: 168,
                    description: "é†‡åšæµ“éƒçš„å¨å£«å¿Œï¼Œæ­é…å†°å—æˆ–è‹æ‰“æ°´ã€‚",
                    keywords: ["å¨å£«å¿Œ", "é†‡åš", "é™ˆå¹´"],
                    fortune: "å“ä¸€å£å¨å£«å¿Œï¼Œæ„Ÿå—æ—¶å…‰æµè½¬ã€‚",
                    image: "https://images.unsplash.com/photo-1527281400683-1aae777175f8"
                },
                {
                    name: "ç²¾é…¿å•¤é…’",
                    price: 68,
                    description: "ç‰¹é€‰ç²¾é…¿å•¤é…’ï¼Œå£æ„Ÿæ¸…çˆ½ï¼Œå›å‘³æ‚ é•¿ã€‚",
                    keywords: ["å•¤é…’", "ç²¾é…¿", "æ¸…çˆ½"],
                    fortune: "ç•…é¥®ç²¾é…¿ï¼Œäº«å—ç”Ÿæ´»ã€‚",
                    image: "https://images.unsplash.com/photo-1608270586620-248524c67de9"
                },
                {
                    name: "æœé¦™å•¤é…’",
                    price: 58,
                    description: "æ¸…æ–°æ°´æœå•¤é…’ï¼Œæ­é…èŠ±ç”Ÿå°é£Ÿã€‚",
                    keywords: ["å•¤é…’", "æœé¦™", "æ¸…æ–°"],
                    fortune: "è½»æ¾æƒ¬æ„ï¼Œå¿«ä¹ç•…é¥®ã€‚",
                    image: "https://images.unsplash.com/photo-1618183479302-1e0aa382c36b"
                }
            ],
            'èŒ¶è‰ºå¸ˆ': [
                {
                    name: "æ­¦å¤·å¤§çº¢è¢",
                    price: 158,
                    description: "å²©éŸµæµ“éƒçš„ä¹Œé¾™èŒ¶ï¼Œé¦™æ°”é†‡åšã€‚",
                    keywords: ["ä¹Œé¾™èŒ¶", "å²©èŒ¶", "é†‡åš"],
                    fortune: "å²©å£æ²‰æ·€ï¼Œç™¾å¹´èŒ¶éŸµã€‚",
                    image: "https://images.unsplash.com/photo-1576092768241-dec231879fc3"
                },
                {
                    name: "æ˜å‰é¾™äº•",
                    price: 138,
                    description: "æ¸…æ–°é›…è‡´çš„ç»¿èŒ¶ï¼Œå¸¦æœ‰æ˜¥å¤©çš„æ°”æ¯ã€‚",
                    keywords: ["ç»¿èŒ¶", "æ¸…æ–°", "æ˜å‰"],
                    fortune: "ä¸€å£æ˜¥èŒ¶ï¼Œå“å‘³æ—¶èŠ‚ã€‚",
                    image: "https://images.unsplash.com/photo-1582793988951-9aed5509eb97"
                },
                {
                    name: "æ­¦å¤·çº¢èŒ¶",
                    price: 128,
                    description: "çº¢èŒ¶ä¸­çš„æå“ï¼Œé¦™æ°”é«˜æ‰¬ã€‚",
                    keywords: ["çº¢èŒ¶", "é¦™æ°”", "æå“"],
                    fortune: "èŒ¶é¦™å››æº¢ï¼ŒéŸµå‘³æ‚ é•¿ã€‚",
                    image: "https://images.unsplash.com/photo-1544787219-7f47ccb76574"
                }
            ]
        };

        // æ ¹æ®å¯¹è¯å…³é”®è¯åŒ¹é…é¥®å“
        function matchDrinksWithKeywords(messages) {
            const extractedKeywords = messages
                .map(msg => msg.textContent.toLowerCase())
                .join(' ');
            
            const drinks = drinkInventory[currentAssistant];
            const matchedDrinks = drinks
                .map(drink => ({
                    drink,
                    score: calculateMatchScore(drink, extractedKeywords)
                }))
                .sort((a, b) => b.score - a.score)
                .slice(0, 3)
                .map(item => item.drink);

            return matchedDrinks;
        }

        // è®¡ç®—åŒ¹é…åˆ†æ•°
        function calculateMatchScore(drink, text) {
            let score = 0;
            drink.keywords.forEach(keyword => {
                if (text.includes(keyword.toLowerCase())) {
                    score += 1;
                }
            });
            return score;
        }

        // æ˜¾ç¤ºé¥®å“åˆ—è¡¨
        function displayDrinks() {
            const drinkGrid = document.getElementById('drink-grid');
            drinkGrid.innerHTML = '';

            // è·å–å½“å‰è§’è‰²çš„é»˜è®¤ä¸‰æ¬¾é¥®å“
            const defaultDrinks = drinkInventory[currentAssistant];

            // æ˜¾ç¤ºé¥®å“å¡ç‰‡
            defaultDrinks.forEach(drink => {
                const drinkCard = document.createElement('div');
                drinkCard.className = 'drink-card';
                drinkCard.innerHTML = `
                    <div class="drink-image-container">
                        <img src="${drink.image}" alt="${drink.name}" class="drink-image" 
                             onerror="this.src='${imageAPIs[currentAssistant]['é»˜è®¤']}'">
                    </div>
                    <div class="drink-content">
                        <div class="drink-info">
                            <h3 class="drink-name">${drink.name}</h3>
                            <p class="drink-price">Â¥${drink.price}</p>
                            <p class="drink-description">${drink.description}</p>
                            <p class="drink-fortune">${drink.fortune}</p>
                        </div>
                        <div class="button-container">
                            <button class="add-to-order" onclick="addToOrder('${drink.name}', ${drink.price})">
                                åŠ å…¥è®¢å•
                            </button>
                        </div>
                    </div>
                `;
                drinkGrid.appendChild(drinkCard);
            });
        }

        // æ·»åŠ åˆ°è®¢å•
        function addToOrder(name, price) {
            let order = JSON.parse(localStorage.getItem('order') || '[]');
            const existingItem = order.find(item => item.name === name);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                order.push({
                    name: name,
                    price: price,
                    quantity: 1
                });
            }
            
            localStorage.setItem('order', JSON.stringify(order));
            alert(`${name} å·²æ·»åŠ åˆ°è®¢å•ï¼`);
        }

        // æ˜¾ç¤ºè®¢å•
        function displayOrder() {
            const order = JSON.parse(localStorage.getItem('order') || '[]');
            const orderItems = document.getElementById('order-items');
            orderItems.innerHTML = '';

            let subtotal = 0;

            order.forEach(item => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;

                const orderItem = document.createElement('div');
                orderItem.className = 'order-item';
                orderItem.innerHTML = `
                    <div class="item-info">
                        <div class="item-name">${item.name}</div>
                        <div class="item-price">Â¥${item.price}</div>
                    </div>
                    <div class="quantity-controls">
                        <button class="quantity-button" onclick="updateQuantity('${item.name}', ${item.quantity - 1})">-</button>
                        <span class="quantity">${item.quantity}</span>
                        <button class="quantity-button" onclick="updateQuantity('${item.name}', ${item.quantity + 1})">+</button>
                    </div>
                `;
                orderItems.appendChild(orderItem);
            });

            document.getElementById('subtotal').textContent = `Â¥${subtotal}`;
            document.getElementById('total').textContent = `Â¥${subtotal}`;
        }

        // æ›´æ–°æ•°é‡
        function updateQuantity(name, newQuantity) {
            if (newQuantity < 0) return;

            const order = JSON.parse(localStorage.getItem('order') || '[]');
            const item = order.find(item => item.name === name);

            if (item) {
                if (newQuantity === 0) {
                    const index = order.indexOf(item);
                    order.splice(index, 1);
                } else {
                    item.quantity = newQuantity;
                }
            }

            localStorage.setItem('order', JSON.stringify(order));
            displayOrder();
        }

        // æäº¤è®¢å•
        function submitOrder() {
            const tableNumber = document.getElementById('table-number').value.trim();
            if (!tableNumber) {
                alert('è¯·è¾“å…¥æ¡Œå·');
                return;
            }

            const order = JSON.parse(localStorage.getItem('order') || '[]');
            if (order.length === 0) {
                alert('è®¢å•ä¸ºç©º');
                return;
            }

            const total = order.reduce((sum, item) => sum + item.price * item.quantity, 0);
            alert(`è®¢å•å·²æäº¤ï¼\næ¡Œå·ï¼š${tableNumber}\næ€»ä»·ï¼šÂ¥${total}`);

            // æ¸…ç©ºè®¢å•
            localStorage.removeItem('order');
            
            // è¿”å›é¦–é¡µ
            document.getElementById('assistant-grid').style.display = 'grid';
            document.getElementById('chat-container').style.display = 'none';
            document.getElementById('menu-container').style.display = 'none';
            document.getElementById('order-container').style.display = 'none';
            document.getElementById('menu-button').style.display = 'none';
            document.getElementById('order-button').style.display = 'none';
        }

        // ç›²ç›’ç‚¹å‡»äº‹ä»¶
        document.getElementById('blind-box').addEventListener('click', () => {
            showMenu();
            document.getElementById('blind-box-container').classList.remove('show');
            document.getElementById('blind-box').classList.remove('show');
        });

        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', () => {
            // æ˜¾ç¤ºåŠ©æ‰‹å¡ç‰‡
            const assistantGrid = document.getElementById('assistant-grid');
            assistantGrid.innerHTML = assistants.map(assistant => `
                <div class="assistant-card" data-assistant="${assistant.name}">
                    <i class="fas ${assistant.icon} assistant-icon"></i>
                    <h3 class="assistant-name">${assistant.name}</h3>
                    <p class="assistant-description">${assistant.description}</p>
                </div>
            `).join('');

            // æ·»åŠ åŠ©æ‰‹å¡ç‰‡ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.assistant-card').forEach(card => {
                card.addEventListener('click', () => {
                    const assistantName = card.getAttribute('data-assistant');
                    selectAssistant(assistantName);
                });
            });

            // æ·»åŠ è¿”å›æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            document.getElementById('back-button').addEventListener('click', () => {
                document.getElementById('assistant-grid').style.display = 'grid';
                document.getElementById('chat-container').style.display = 'none';
                document.getElementById('menu-container').style.display = 'none';
                document.getElementById('order-container').style.display = 'none';
                document.getElementById('menu-button').style.display = 'none';
                document.getElementById('order-button').style.display = 'none';
            });

            // æ·»åŠ å‘é€æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            document.getElementById('send-button').addEventListener('click', sendMessage);

            // æ·»åŠ è¾“å…¥æ¡†å›è½¦äº‹ä»¶
            document.getElementById('user-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // æ·»åŠ å¯¼èˆªæŒ‰é’®ç‚¹å‡»äº‹ä»¶
            document.getElementById('menu-button').addEventListener('click', showMenu);
            document.getElementById('order-button').addEventListener('click', showOrder);
        });

        let currentAssistant = '';
        let messageCount = 0;

        // é€‰æ‹©åŠ©æ‰‹
        function selectAssistant(name) {
            document.getElementById('assistant-grid').style.display = 'none';
            document.getElementById('chat-container').style.display = 'block';
            document.getElementById('menu-container').style.display = 'none';
            document.getElementById('order-container').style.display = 'none';
            document.getElementById('menu-button').style.display = 'none';
            document.getElementById('order-button').style.display = 'none';
            
            currentAssistant = name;
            messageCount = 0;
            
            // å®šä¹‰æ¯ä¸ªè§’è‰²çš„ä¸‰å¥å¯¹è¯
            const dialogueSequence = {
                'è°ƒé…’å¸ˆ': [
                    '(å¼€å¿ƒåœ°è¹¦è·³) æ¬§å°¼é…±~æˆ‘æ˜¯å¯çˆ±çš„è°ƒé…’å¸ˆ,å¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡å“¦!',
                    '(ä¿çš®åœ°è½¬åœˆ) æ¬§å°¼é…±çœ‹èµ·æ¥å¥½å¯çˆ±å‘¢~è®©å’±å®¶çŒœçŒœæ‚¨ä»Šå¤©çš„å¿ƒæƒ…å¦‚ä½•?',
                    '(æ¯”å‡ºå°çˆ±å¿ƒ) æ¬§å°¼é…±è¦ä¸è¦è¯•è¯•å’±å®¶çš„æ‹›ç‰Œ"æ¢¦å¹»æ˜Ÿç©ºç‰¹è°ƒ"?åŠ å…¥äº†é—ªç²‰å’Œè“æŸ‘æ©˜åŠ›å¨‡é…’,å–ä¸‹å»æ•´ä¸ªäººéƒ½ä¼šå‘å…‰å‘¢âœ¨'
                ],
                'å“é…’å¸ˆ': [
                    '(ä¼˜é›…åœ°æ¬ èº«) æ¬§å°¼é…±å¥½~æˆ‘æ˜¯ä¸“ä¸šçš„å“é…’å¸ˆ,è®©æˆ‘å¸¦æ‚¨è¿›å…¥è‘¡è„é…’çš„å¥‡å¦™ä¸–ç•Œå§!',
                    '(è½»è½»æ•´ç†è£™æ‘†) æ¬§å°¼é…±ä»Šå¤©æ‰“æ‰®å¾—çœŸæ¼‚äº®å‘¢~åƒæ˜¯æ˜¥å¤©é‡Œæœ€ç¾ä¸½çš„èŠ±æœµ~',
                    '(å¼€å¿ƒåœ°è½¬åœˆ) æ¬§å°¼é…±ä¸å¦‚å…ˆå°å°è¿™æ”¯2015å¹´çš„æ³¢å°”å¤šçº¢é…’?å¸¦ç€é»‘é†‹æ —å’Œç«ç‘°èŠ±é¦™,è¶…çº§æµªæ¼«çš„!'
                ],
                'é…’ä¿': [
                    '(æ´»åŠ›æ»¡æ»¡åœ°æŒ¥æ‰‹) æ¬§å°¼é…±æ¥å•¦~æˆ‘æ˜¯å…ƒæ°”æ»¡æ»¡çš„é…’ä¿,å‡†å¤‡å¥½æ¥ä¸€åœºå¼€å¿ƒçš„ç•…é¥®äº†å—?',
                    '(ä¿çš®åœ°çœ¨çœ¼) æ¬§å°¼é…±çœ‹èµ·æ¥ä»Šå¤©å¿ƒæƒ…ä¸é”™å‘¢~æ˜¯é‡åˆ°ä»€ä¹ˆå¼€å¿ƒçš„äº‹äº†å—?',
                    '(çœ¨çœ¨çœ¼ç›) å…ˆæ¥ä¸€æ¯"é™ˆå¹´å¨å£«å¿Œ"æ€ä¹ˆæ ·?å’±å®¶ç‰¹åˆ«æ¨èé…å†°å—æˆ–è‹æ‰“æ°´,è¶…è§£å‹çš„å“¦~'
                ],
                'èŒ¶è‰ºå¸ˆ': [
                    '(æ¸©æŸ”åœ°å¾®ç¬‘) æ¬§å°¼é…±æ‚¨å¥½~æˆ‘æ˜¯èŒ¶è‰ºå¸ˆ,è®©æˆ‘ä¸ºæ‚¨çŒ®ä¸Šä¸€æ¯æ¸…é›…çš„èŒ¶é¥®å§!',
                    '(ä¼˜é›…åœ°æ•´ç†è¡£è¢–) æ¬§å°¼é…±èº«ä¸Šæœ‰ä¸€ç§æ·¡æ·¡çš„ä¼˜é›…æ°”è´¨å‘¢~è®©å’±å®¶æƒ³èµ·äº†æ™¨éœ²ä¸­çš„èŒ‰è‰èŠ±~',
                    '(ä¼˜é›…åœ°æ–ŸèŒ¶) ä¸å¦‚å…ˆå“å°è¿™æ¬¾"æ­¦å¤·å¤§çº¢è¢"?å²©éŸµé†‡åš,å›ç”˜æ‚ é•¿,æ˜¯å’±å®¶çš„çè—å“¦!'
                ]
            };

            // å‘é€ç¬¬ä¸€å¥å¼€åœºç™½
            addMessage(dialogueSequence[name][0], 'bot');
        }

        // è·å–åŠ©æ‰‹å›å¤
        async function getAssistantResponse(message) {
            try {
                const sentiment = analyzeSentimentLocally(message);
                const responses = {
                    'è°ƒé…’å¸ˆ': {
                        positive: [
                            '(å¼€å¿ƒåœ°è¹¦è·³) æ¬§å°¼é…±~è¦ä¸è¦è¯•è¯•èè‰ã®ç§˜å¯†ç‰¹è°ƒï¼ŸåŠ å…¥äº†é—ªç²‰çš„é¸¡å°¾é…’ï¼Œå–ä¸‹å»æ•´ä¸ªäººéƒ½ä¼šå‘å…‰å‘¢âœ¨',
                            '(ä¿çš®åœ°è½¬åœˆåœˆ) å‘œå‘œ~å¤ªæ£’å•¦ï¼è®©æˆ‘ä¸ºæ‚¨è°ƒåˆ¶ä¸€æ¯"æ‹çˆ±æ°”æ³¡"ï¼Œç²‰ç²‰çš„é¢œè‰²è¶…å¯çˆ±çš„è¯´ï¼ğŸ’•',
                            '(æ¯”å‡ºå°çˆ±å¿ƒ) æ¬§å°¼é…±çœŸæ‡‚å‘¢ï¼è¿™æ¯"é­”æ³•å°‘å¥³ç‰¹é¥®"æˆ‘åŠ äº†æ£‰èŠ±ç³–å’Œçˆ±å¿ƒç³–ç‰‡ï¼Œå¯çˆ±åˆ°çˆ†ç‚¸å•¦~ğŸ¦„'
                        ],
                        negative: [
                            '(å§”å±ˆåœ°å™˜å˜´) å‘œ...ä¸åˆæ¬§å°¼é…±å£å‘³å—ï¼Ÿè®©å’±å®¶å˜ä¸ªé­”æ³•ï¼Œè°ƒåˆ¶"å¿ƒæƒ…æ²»æ„ˆç‰¹è°ƒ"ï¼ŒåŠ å…¥è¶è±†èŠ±ä¼šå˜è‰²çš„å“¦ï¼',
                            '(æ‹…å¿ƒåœ°æ‘‡å¤´) å•Šå•¦~æ˜¯å’±å®¶è€ƒè™‘ä¸å‘¨åˆ°äº†å‘¢ã€‚è¦è¯•è¯•"å½©è™¹å¿ƒæƒ…æ¯"å—ï¼Ÿä¸ƒå±‚æ¸å˜è‰²è¶…æ¢¦å¹»çš„ï¼',
                            '(çœ¼æ³ªæ±ªæ±ª) å¯¹ä¸èµ·å•¦æ¬§å°¼é…±~è®©å’±å®¶é‡æ–°è°ƒåˆ¶ä¸€æ¯"é­”æ³•å°‘å¥³ç‰¹é¥®"ï¼Œä¿è¯è®©æ‚¨éœ²å‡ºç¬‘å®¹ï¼'
                        ],
                        neutral: [
                            '(ç¥ç§˜åœ°çœ¨çœ¼) æ¬§å°¼é…±~ä»Šå¤©çš„å¹¸è¿é¥®å“æ˜¯..."æ˜Ÿæ˜Ÿé­”æ³•ç‰¹è°ƒ"ï¼æ¯å­ä¸Šè¿˜æœ‰å°æ˜Ÿæ˜Ÿè£…é¥°å‘¢âœ¨',
                            '(å¼€å¿ƒåœ°æ‘‡æ™ƒè°ƒé…’å™¨) è®©å’±å®¶ä¸ºæ¬§å°¼é…±è°ƒåˆ¶ä¸€æ¯"æ¢¦å¹»æ³¡æ³¡"ï¼Œå–ä¸‹å»å˜´å·´ä¼šäº®æ™¶æ™¶çš„å“¦~',
                            '(è¹¦è¹¦è·³è·³) æ¬§å°¼é…±è¦è¯•è¯•å’±å®¶çš„æ–°å“"ç‹¬è§’å…½ã®æ³ª"å—ï¼Ÿæ¯å£ä¸Šæœ‰å½©è™¹ç³–è£…é¥°å‘¢ï¼'
                        ]
                    },
                    'å“é…’å¸ˆ': {
                        positive: [
                            '(ä¼˜é›…åœ°æ¬ èº«) æ¬§å°¼é…±æ‡‚å¾—çœŸå¤šå‘¢~è¿™æ¬¾2015å¹´çš„æ³¢å°”å¤šï¼Œé¦™æ°”åƒæ˜¯æ™šéœä¸­çš„ç«ç‘°èŠ±å›­ï¼Œè¦å°å°çœ‹å—ï¼Ÿ',
                            '(è½»è½»æ™ƒåŠ¨é…’æ¯) å‘œ~æ¬§å°¼é…±çš„å“å‘³çœŸæ˜¯å¤ªæ£’äº†ï¼è¿™æ”¯å‹ƒè‰®ç¬¬å¸¦ç€æ˜¥å¤©çš„æ°”æ¯ï¼Œå–ä¸€å£å°±èƒ½æ„Ÿå—åˆ°çˆ±æƒ…çš„å‘³é“...',
                            '(å¼€å¿ƒåœ°è½¬åœˆ) å¤ªæ£’å•¦ï¼æ¬§å°¼é…±æ‡‚å¾—çœŸå¤šï¼è¿™æ”¯æ™®ç½—æ—ºæ–¯ç«ç‘°é…’ï¼Œå°±åƒæ˜¯æ‹çˆ±çš„å‘³é“å‘¢~'
                        ],
                        negative: [
                            '(æ‹…å¿ƒåœ°æ­ªå¤´) å‘œ...æ¬§å°¼é…±å¿ƒæƒ…ä¸å¥½å—ï¼Ÿè®©å’±å®¶ä¸ºæ‚¨æŒ‘é€‰ä¸€æ¬¾æ¸©æŸ”çš„æ¡ƒçº¢è‘¡è„é…’ï¼Œç”œç”œçš„å¾ˆæ²»æ„ˆå“¦...',
                            '(è½»è½»æŠ¿å˜´) ä¸è¦éš¾è¿‡å•¦~è¿™æ¬¾æ„å¤§åˆ©èµ·æ³¡é…’ï¼Œæ°”æ³¡åƒæ˜¯å¿«ä¹çš„å°ç²¾çµï¼Œä¸€å®šèƒ½è®©æ¬§å°¼é…±å¼€å¿ƒèµ·æ¥ï¼',
                            '(çœ¨å·´çœ¼ç›) æ¬§å°¼é…±~è®©å’±å®¶ç”¨è¿™æ”¯å¾®é†ºçš„è«æ–¯å¡æ‰˜ï¼Œå¸¦èµ°æ‚¨æ‰€æœ‰çš„çƒ¦æ¼å§ï¼'
                        ],
                        neutral: [
                            '(ä¿çš®åœ°è½¬åŠ¨é…’æ¯) æ¬§å°¼é…±~ä»Šæ™šçš„æ¨èæ˜¯æ¥è‡ªå—æ¾³çš„ç²¾çµä¹‹æ³ªï¼Œå–ä¸€å£å°±èƒ½æ„Ÿå—åˆ°æ˜Ÿç©ºçš„é­”åŠ›å“¦ï¼',
                            '(ç¥ç§˜åœ°çœ¨çœ¼) è¦ä¸è¦è¯•è¯•è¿™æ”¯ç‹¬è§’å…½ä¹‹å»ï¼Ÿå¸¦ç€é­”æ³•èˆ¬çš„æœé¦™ï¼Œè¶…çº§æ¢¦å¹»çš„ï¼',
                            '(å¼€å¿ƒåœ°è·³è·ƒ) æ¬§å°¼é…±çœ‹è¿™ä¸ªï¼è¿™æ¬¾ç¥ç€è‰²çš„æ©™é…’ï¼Œå–ä¸‹å»æ•´ä¸ªäººéƒ½ä¼šå‘å…‰å‘¢~'
                        ]
                    },
                    'é…’ä¿': {
                        positive: [
                            '(å¼€å¿ƒåœ°æ“¦æ¯å­) æ¬§å°¼é…±ä»Šå¤©å¿ƒæƒ…ä¸é”™å‘¢ï¼æ¥æ¯"å…ƒæ°”æ»¡æ»¡ç‰¹è°ƒ"ï¼Œå–äº†ä¼šå˜å¾—æ›´å¯çˆ±å“¦ï¼',
                            '(ä¿çš®åœ°æŠ›é…’ç“¶) å‘œå‘œ~æ¬§å°¼é…±çœŸæ‡‚ï¼è¦ä¸è¦è¯•è¯•"å¹¸è¿æ˜Ÿæ˜Ÿç‰¹é¥®"ï¼Ÿä¼šå¸¦æ¥å¥½è¿çš„è¯´ï¼',
                            '(æ¯”å‡ºèƒœåˆ©æ‰‹åŠ¿) æ¬§å°¼é…±æœ€æ£’äº†ï¼æ¥ä¸€æ¯"å½©è™¹å¹¸ç¦æ°´"ï¼Œä¿è¯ç”œç”œçš„è¶…æ²»æ„ˆï¼'
                        ],
                        negative: [
                            '(æ‹…å¿ƒåœ°æ­ªå¤´) æ¬§å°¼é…±æ˜¯ä¸æ˜¯é‡åˆ°å›°éš¾äº†ï¼Ÿæ¥æ¯"é­”æ³•æ²»æ„ˆæ°´"ï¼Œå–å®Œçƒ¦æ¼å°±ä¼šæ¶ˆå¤±ä¸è§ï¼',
                            '(è½»è½»æ‹æ‰‹) ä¸è¦ä¼¤å¿ƒå•¦~è¿™æ¯"å¼€å¿ƒæœæ±"åŠ äº†ç‰¹åˆ¶ç³–æµ†ï¼Œç”œåº¦å’Œæ¬§å°¼é…±ä¸€æ ·å‘¢ï¼',
                            '(çœ¨çœ¨çœ¼ç›) æ¬§å°¼é…±~è®©å’±å®¶çš„"å…ƒæ°”å¤æ´»ç‰¹è°ƒ"ï¼Œæ²»æ„ˆæ‚¨çš„å¿ƒæƒ…å§ï¼'
                        ],
                        neutral: [
                            '(ç¥ç§˜åœ°æ‘‡æ™ƒè°ƒé…’å™¨) æ¬§å°¼é…±è¦æ¥ç‚¹ç‰¹åˆ«çš„å—ï¼Ÿè¿™æ¬¾"é­”æ³•æ˜Ÿæ˜Ÿæ°´"ï¼Œå–äº†ä¼šå¸¦æ¥å¥½è¿å“¦ï¼',
                            '(å¼€å¿ƒåœ°å“¼æ­Œ) ä¸ºæ¬§å°¼é…±ç‰¹åˆ¶çš„"å¹¸è¿è‰ç‰¹è°ƒ"ï¼Œæ®è¯´èƒ½å®ç°ä¸€ä¸ªæ„¿æœ›å‘¢~',
                            '(è¹¦è¹¦è·³è·³) æ¬§å°¼é…±å¿«çœ‹ï¼è¿™æ¯"å½©è™¹æ¢¦å¹»æ°´"ï¼Œå–å®Œæ•´ä¸ªäººéƒ½ä¼šé—ªé—ªå‘å…‰ï¼'
                        ]
                    },
                    'èŒ¶è‰ºå¸ˆ': {
                        positive: [
                            '(ä¼˜é›…åœ°æ§èŒ¶) æ¬§å°¼é…±çœŸæ˜¯æ‡‚èŒ¶å‘¢~è¿™å£¶å¤§çº¢è¢ï¼Œé¦™æ°”åƒæ˜¯ä»™å¢ƒçš„èŠ±å›­ï¼Œè¦ä¸€èµ·å“å°å—ï¼Ÿ',
                            '(è½»è½»æ‘†å¼„èŒ¶å…·) å‘œ~æ¬§å°¼é…±çš„å“å‘³çœŸæ˜¯å¤ªæ£’äº†ï¼è¿™æ¬¾ç¢§èºæ˜¥å¸¦ç€æ˜¥å¤©çš„æ°”æ¯ï¼Œå–ä¸€å£å°±èƒ½æ„Ÿå—åˆ°å¹¸ç¦...',
                            '(å¼€å¿ƒåœ°æ–ŸèŒ¶) å¤ªæ£’å•¦ï¼æ¬§å°¼é…±æ‡‚å¾—çœŸå¤šï¼è¿™å£¶æ­¦å¤·å²©èŒ¶ï¼Œå°±åƒæ˜¯ä»™å¥³çš„çœ¼æ³ªä¸€æ ·çè´µå‘¢~'
                        ],
                        negative: [
                            '(æ‹…å¿ƒåœ°æ­ªå¤´) å‘œ...æ¬§å°¼é…±å¿ƒæƒ…ä¸å¥½å—ï¼Ÿè®©å’±å®¶ä¸ºæ‚¨æ³¡ä¸€å£¶æ¸©æŸ”çš„é“è§‚éŸ³ï¼Œç”˜ç”œçš„å›å‘³ä¼šæ²»æ„ˆæ‚¨çš„å¿ƒæƒ…...',
                            '(è½»è½»æŠ¿å˜´) ä¸è¦éš¾è¿‡å•¦~è¿™æ¬¾ç™½æ¯«é“¶é’ˆï¼Œæ¸…æ·¡ä¸­å¸¦ç€ç”œæ„ï¼Œå°±åƒæ˜¯å°å¤©ä½¿çš„ç¾½æ¯›ä¸€æ ·æ¸©æŸ”ï¼',
                            '(çœ¨å·´çœ¼ç›) æ¬§å°¼é…±~è®©å’±å®¶ç”¨è¿™å£¶é¾™äº•èŒ¶ï¼Œå¸¦èµ°æ‚¨æ‰€æœ‰çš„çƒ¦æ¼å§ï¼'
                        ],
                        neutral: [
                            '(ä¿çš®åœ°æ‘†å¼„èŒ¶ç›) æ¬§å°¼é…±~ä»Šå¤©ä¸ºæ‚¨æ¨èä¸€æ¬¾é­”æ³•æ™®æ´±ï¼Œå–ä¸€å£å°±èƒ½æ„Ÿå—åˆ°æ—¶å…‰çš„é­”åŠ›å“¦ï¼',
                            '(ç¥ç§˜åœ°çœ¨çœ¼) è¦ä¸è¦è¯•è¯•è¿™å£¶ä»™å¥³ã®æ³ªï¼Ÿå¸¦ç€äº‘é›¾çš„ä»™æ°”ï¼Œè¶…çº§æ¢¦å¹»çš„ï¼',
                            '(å¼€å¿ƒåœ°è·³è·ƒ) æ¬§å°¼é…±çœ‹è¿™ä¸ªï¼è¿™æ¬¾é‡‘éªçœ‰ï¼Œå–ä¸‹å»æ•´ä¸ªäººéƒ½ä¼šå˜å¾—ä¼˜é›…å‘¢~'
                        ]
                    }
                };

                // è·å–å½“å‰è§’è‰²çš„å›å¤åˆ—è¡¨
                const currentResponses = responses[currentAssistant][sentiment];
                
                // æ ¹æ®å¯¹è¯æ¬¡æ•°è¿”å›å›ºå®šçš„å›å¤
                return currentResponses[messageCount];
            } catch (error) {
                console.error('Error in getAssistantResponse:', error);
                return 'è®©å’±å®¶ä¸ºæ¬§å°¼é…±æ¨èä¸€æ¬¾ç‰¹åˆ«çš„é¥®å“å§~';
            }
        }

        // æœ¬åœ°æƒ…æ„Ÿåˆ†æå‡½æ•°
        function analyzeSentimentLocally(text) {
            const positiveKeywords = ['å¥½', 'å–œæ¬¢', 'æ£’', 'èµ', 'ä¸é”™', 'æ»¡æ„', 'ç¾å‘³', 'å¥½å–', 'æ¨è', 'å–œæ¬¢', 'çˆ±', 'æ£’æäº†', 'å¤ªæ£’äº†', 'å®Œç¾', 'æƒŠè‰³', 'æœŸå¾…', 'å¼€å¿ƒ', 'å¿«ä¹', 'æ¸©æš–', 'æ„ŸåŠ¨'];
            const negativeKeywords = ['å·®', 'ä¸å–œæ¬¢', 'éš¾å–', 'è´µ', 'å¤±æœ›', 'éš¾åƒ', 'ä¸å¥½', 'ç³Ÿç³•', 'å·®åŠ²', 'éš¾å–', 'è´µ', 'è´µäº†', 'å¤ªè´µ', 'ä¸å€¼', 'å¤±æœ›', 'ä¼¤å¿ƒ', 'éš¾è¿‡', 'å‹åŠ›', 'çƒ¦æ¼', 'ç´¯'];
            
            if (positiveKeywords.some(keyword => text.includes(keyword))) {
                return 'positive';
            } else if (negativeKeywords.some(keyword => text.includes(keyword))) {
                return 'negative';
            }
            return 'neutral';
        }

        // å‘é€æ¶ˆæ¯
        async function sendMessage() {
            const input = document.getElementById('user-input');
            const message = input.value.trim();
            
            if (message) {
                addMessage(message, 'user');
                input.value = '';
                
                try {
                    // è·å–åŠ©æ‰‹å›å¤
                    const response = await getAssistantResponse(message);
                    addMessage(response, 'bot');
                    
                    messageCount++;
                    if (messageCount >= 3) {
                        showBlindBox();
                    }
                } catch (error) {
                    console.error('Error getting response:', error);
                    addMessage('æŠ±æ­‰ï¼Œæˆ‘é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œè¯·ç¨åå†è¯•ã€‚', 'bot');
                }
            }
        }

        // æ·»åŠ æ¶ˆæ¯
        function addMessage(text, sender) {
            const messages = document.getElementById('chat-messages');
            const message = document.createElement('div');
            message.className = `message ${sender}`;
            message.textContent = text;
            messages.appendChild(message);
            messages.scrollTop = messages.scrollHeight;
        }

        // æ˜¾ç¤ºç›²ç›’
        function showBlindBox() {
            const blindBoxContainer = document.getElementById('blind-box-container');
            blindBoxContainer.classList.add('show');
            setTimeout(() => {
                const blindBox = document.getElementById('blind-box');
                blindBox.classList.add('show');
            }, 100);
        }

        // æ˜¾ç¤ºèœå•
        function showMenu() {
            document.getElementById('assistant-grid').style.display = 'none';
            document.getElementById('chat-container').style.display = 'none';
            document.getElementById('menu-container').style.display = 'block';
            document.getElementById('order-container').style.display = 'none';
            document.getElementById('menu-button').style.display = 'none';
            document.getElementById('order-button').style.display = 'block';
            displayDrinks();
        }

        // æ˜¾ç¤ºè®¢å•
        function showOrder() {
            document.getElementById('assistant-grid').style.display = 'none';
            document.getElementById('chat-container').style.display = 'none';
            document.getElementById('menu-container').style.display = 'none';
            document.getElementById('order-container').style.display = 'block';
            document.getElementById('menu-button').style.display = 'block';
            document.getElementById('order-button').style.display = 'none';
            displayOrder();
        }
    </script>
</body>

</html>
    
    